<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="477px" preserveAspectRatio="none" style="width:662px;height:477px;" version="1.1" viewBox="0 0 662 477" width="662px" zoomAndPan="magnify"><defs><filter height="300%" id="fh578527kfcx7" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster Zeek--><rect fill="#FEFECE" filter="url(#fh578527kfcx7)" height="406.5" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="306" x="231" y="59.5"/><rect fill="#FFFFFF" height="374.0117" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="300" x="234" y="88.9883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="231" x2="537" y1="85.9883" y2="85.9883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="368" y="77.0352">Zeek</text><!--cluster Kafka--><rect fill="#FEFECE" filter="url(#fh578527kfcx7)" height="85" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="556" y="270"/><rect fill="#FFFFFF" height="52.5117" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="88" x="559" y="299.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="556" x2="650" y1="296.4883" y2="296.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="584" y="287.5352">Kafka</text><rect fill="#FEFECE" filter="url(#fh578527kfcx7)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="404" y="86.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="404" x2="506" y1="112.9883" y2="112.9883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="414" y="105.0352">Zeek_Server</text><rect fill="#FEFECE" filter="url(#fh578527kfcx7)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="392.5" y="408"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="392.5" x2="491.5" y1="434.4883" y2="434.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="402.5" y="426.5352">Zeek_Client</text><rect fill="#FEFECE" filter="url(#fh578527kfcx7)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="239" y="86.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="239" x2="295" y1="112.9883" y2="112.9883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="249" y="105.0352">SSHD</text><rect fill="#FEFECE" filter="url(#fh578527kfcx7)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="239" y="408"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="239" x2="343" y1="434.4883" y2="434.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="249" y="426.5352">Zeek_Broker</text><rect fill="#FEFECE" filter="url(#fh578527kfcx7)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="564.5" y="297"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="564.5" x2="641.5" y1="323.4883" y2="323.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="574.5" y="315.5352">produce</text><rect fill="#FEFECE" filter="url(#fh578527kfcx7)" height="207.4883" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="198" x="6" y="8"/><rect fill="#FFFFFF" height="175" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="192" x="9" y="37.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="6" x2="204" y1="34.4883" y2="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="74.5" y="26.5352">Logstash</text><rect fill="#FEFECE" filter="url(#fh578527kfcx7)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="17" y="47.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="17" x2="125" y1="73.9766" y2="73.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="27" y="66.0234">kafka_plugin</text><rect fill="#FEFECE" filter="url(#fh578527kfcx7)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="103" x="19.5" y="150.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="19.5" x2="122.5" y1="176.9766" y2="176.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="29.5" y="169.0234">ssl_protocol</text><!--link kafka_plugin to ssl_protocol--><path d="M71,97.6849 C71,112.0251 71,130.0845 71,145.1936 " fill="none" id="kafka_plugin-ssl_protocol" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="71,150.1948,75,141.1948,71,145.1948,67,141.1948,71,150.1948" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="72" y="129.0566">Meta_brokerlist</text><!--link Zeek_Server to Zeek_Client--><path d="M428.1069,136.7611 C399.4105,165.7406 355.6955,216.2321 338,270 C326.1901,305.8844 321.1053,321.2105 338,355 C348.7443,376.4886 368.5353,393.5931 387.9917,406.2439 " fill="none" id="Zeek_Server-Zeek_Client" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="392.3964,409.0378,386.939,400.8392,388.1742,406.3596,382.6538,407.5947,392.3964,409.0378" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="339" y="327.0684">SSHD :Logs</text><!--link Zeek_Client to Zeek_Server--><path d="M443.0153,407.8896 C445.3744,349.5486 451.2184,205.0213 453.7725,141.858 " fill="none" id="Zeek_Client-Zeek_Server" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="453.9799,136.7276,449.6193,145.5585,453.7778,141.7235,457.6128,145.882,453.9799,136.7276" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="449" y="327.0684">SSHD :Logs</text><!--link SSHD to Zeek_Broker--><path d="M268.8832,136.7276 C273.247,195.1838 284.0362,339.7143 288.7432,402.7687 " fill="none" id="SSHD-Zeek_Broker" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="289.1255,407.8896,292.4443,398.6167,288.7532,402.9035,284.4665,399.2124,289.1255,407.8896" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Zeek_Server to produce--><path d="M472.8523,136.8912 C500.4284,176.1126 553.2402,251.2268 582.3965,292.6957 " fill="none" id="Zeek_Server-produce" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="585.3148,296.8464,583.4105,287.1834,582.439,292.7562,576.8662,291.7847,585.3148,296.8464" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="560" y="258.5684">Broker :SSL</text><!--
@startuml



state Zeek {

Zeek_Server - -> Zeek_Client : SSHD :Logs
Zeek_Client - -> Zeek_Server : SSHD :Logs
 SSHD - -> Zeek_Broker

}


state Kafka {

 Zeek_Server - -> produce : Broker :SSL
}

state Logstash {

kafka_plugin - -> ssl_protocol : Meta_brokerlist

}

@enduml

PlantUML version 1.2018.14(Fri Dec 21 08:33:16 PST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_151-b12
Operating System: Mac OS X
OS Version: 10.14.2
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>